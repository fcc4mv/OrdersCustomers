<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<!-- These 2 versions below MUST MATCH!! -->
		<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.3.5/angular.min.js"></script>
		<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.3.5/angular-route.min.js"></script>

		<script type="text/javascript">
				//  inject the ngRoute dependency in the module.
			var myApp = angular.module('myApp', ['ngRoute']);
				//  use the config method to set up routing:
			myApp.config(function ($routeProvider){
				$routeProvider
				    .when('/customers',{
						templateUrl: 'partials/customers.html'
					})
					.when('/orders',{
						templateUrl: 'partials/orders.html'
					})
					.otherwise({
						redirectTo: '/'
					});
				});

				// Create a factory (attached to this module)
			myApp.factory('CustomerFactory', function (){
				// The factory is nothing more than a function that returns an object
				var customers = [];
				var factory = {};
					// Add a getUsers key to the factory object with a value of a function.
				factory.getCustomers = function(callback){
					// Pass the users to a callback to be used by whoever calls the method
					console.log("getting customers");
					callback(customers);

				}
				factory.addCustomers = function(newCustomer){
					customers.push(newCustomer);
				}
				factory.deleteCustomers = function(customer){
					customers.splice(customers.indexOf(customer), 1);
				}
				// Most important step: return the object so it can be used by the rest of our angular code
				return factory;
			});

				// The .controller() method adds a UserLists controller to the module
			myApp.controller('CustomersController', function ($scope, CustomerFactory){
				$scope.customers = [];

				CustomerFactory.getCustomers(function(data){
					$scope.customers = data;
					console.log("I'm in CustomerFactory - get method", $scope.customers)
				});

				$scope.addCustomers = function(){
					CustomerFactory.addCustomers($scope.newCustomer);
					$scope.newCustomer = {};
					console.log("I'm in CustomerFactory - post method", $scope.customers)
				};

				$scope.deletePlayers = function(player){
					PlayerFactory.deletePlayers(player);
					console.log("I'm in PlayersController - post method", $scope.players)
				}

			});

			myApp.controller('ordersController', function ($scope, CustomerFactory){
				$scope.orders = [];
				$scope.customers = [];


				CustomerFactory.getOrders(function(data){
					$scope.orders = data;
					console.log("I'm in ordersController - get orders method", $scope.orders)
				});

				CustomerFactory.getCustomers(function(data){
					$scope.customers = data;

				})

				$scope.addOrders = function(){
					// console.log("add assoc ", $scope.newAssociation)
					CustomerFactory.addOrders($scope.newOrders);
					$scope.newOrders = {};
				};

				$scope.deleteOrders = function(order){
					// $scope.associations.slice($scope.associations.indexOf($scope.association), 1);
					CustomerFactory.deleteOrders(order);
				};

			});

		</script>
	</head>
	<body>
		<div ng-app='myApp'>
			<a href='#/orders'>Orders</a> | <a href='#/customers'>Customers</a>
			<div ng-view=''>
			</div>
		</div>
	</body>
</html>

<style type="text/css">
	*{
		font-family: Tahoma;
	}
</style>
